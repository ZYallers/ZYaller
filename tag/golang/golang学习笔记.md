# golang学习笔记

### 2018/6/14

#### 1. 并发
Go 语言对并发的支持是这门语言最重要的特性之一。 goroutine 很像线程，但是它占用的
内存远少于线程，使用它需要的代码更少。通道（channel）是一种内置的数据结构，可以让
用户在不同的 goroutine 之间同步发送具有类型的消息。这让编程模型更倾向于在 goroutine
之间发送消息，而不是让多个 goroutine 争夺同一个数据的使用权。让我们看看这些特性的
细节。

#### 2. 通道
通道是一种数据结构，可以让 goroutine 之间进行安全的数据通信。通道可以帮用户避免其
他语言里常见的共享内存访问的问题。

并发的最难的部分就是要确保其他并发运行的进程、线程或 goroutine 不会意外修改用户的
数据。当不同的线程在没有同步保护的情况下修改同一个数据时，总会发生灾难。在其他语言中，
如果使用全局变量或者共享内存，必须使用复杂的锁规则来防止对同一个变量的不同步修改。

为了解决这个问题，通道提供了一种新模式，从而保证并发修改时的数据安全。通道这一模
式保证同一时刻只会有一个 goroutine 修改数据。通道用于在几个运行的 goroutine 之间发送数据。

注：记住应该在生产者的地方关闭channel，而不是消费的地方去关闭它，这样容易引起panic。

#### 3. Go Playground
Go Playground 允许在浏览器里编辑并运行 Go 语言代码。在浏览器中打开 http://play.golang.org。
浏览器里展示的代码是可编辑的

#### 4. 怎样学习
比查阅相关学习资源更重要的是--动手编码。毕竟我们学习的是软件开发技术，用代码说话是学习这类技术的有效途径。
在编码过程中，我们可以感受到这门编程语言的鲜活性。只有积累了足够的代码量，我们才可以感悟到很多更高层次的思想，比如Go语言背后的哲学。

#### 5. 其他
rune是int32的别称，byte是uint8的别称。

由于长度也是数组类型的一部分，因此[3]int与[4]int是不同的类型，数组也就不能改变长度。数组之间的赋值是值的赋值，即当把一个数组作为参数
传人函数的时候，传入的其实是该数组的副本，而不是它的指针。如果使用指针，那么就需要用到slice类型。

map是无序的，每次打印出来的map都会不一样，它不能通过index获取，而必须通过key获取。map的长度是不固定的，也就是和slice一样，也是一种引用类型。

new返回指针。内建函数make与new有着不同的功能，make只能创建slice、map和channel，并且返回一个有初始值（非零）的T类型，而不是*T。

go里面switch默认相当于每个case最后带有break，匹配成功后不会自动向下执行其他case，而是跳出整个switch，但是可以使用fallthrough强制执行后面的case代码。

go语言中string、slice、map这三种类型的实现机制类似指针，所以可以直接传递，而不用取地址后传递指针。注意，若函数需改变slice的长度，则依旧需要取地址传递指针。

defer语句会在当函数执行到最后时会按照逆序（后进先出模式）执行，最后该函数返回。

recover是一个内建的函数，可以让进入令人恐慌的goroutine恢复过来。recover仅在延迟defer函数中有效。

runtime.Gosched()表示让CPU把时间片让给别人，下次某个时候继续恢复执行该goroutine。

#### 6. Conn的goroutine
与我们一般编写的http服务器不同，Go语言为了实现高并发和高性能，使用goroutines处理Conn的读写事件，这样每个请求都能保持独立，相互不会阻塞，以高效响应网络事件，这是Go语言高效的保证。




